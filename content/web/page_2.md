---
title: "Web画面を表示してみよう"
pre: "<b>2. </b>"
weight: 2
---
まずは Google Apps Script でアプリケーションを作成する第一歩として、
ブラウザにWeb画面を表示してみましょう。

### スクリプトの種類
Google Apps Script には2種類のスクリプトがあります。

- Container Bound Script
- Standalone Script

それぞれのスクリプトの違いについて確認していきましょう。

#### Container Bound Script
Google スプレッドシートやドキュメントなどの各アプリケーションのメニューから作成することができるスクリプトです。

**＜スクリプトを作成する手順＞**
1. Google スプレッドシートやドキュメントなどのアプリケーションを開きます。
1. 上部メニューの|[ツール] > [スクリプトエディタ]を選択します。

**＜メリット＞**
- バインドしているファイルを簡単に参照できる
- バインドしているファイルから Google Apps Script を実行できる

この方法で作成されたスクリプトと同アプリケーションはバインド（結びつく）しているため、
スプレッドシートの場合は下記のメソッドによりブラウザで開いている同スプレッドシートを操作することができます。
```js
var spreadsheet = SpreadsheetApp.getActiveSpreadsheet();
var sheet = spreadsheet.getActiveSheet();
var range = sheet.getActiveRange();
```

また、onOpen関数を利用してアプリケーションにメニューを追加し、
そのメニューからスクリプトエディタでコーディングした関数を実行することができます。
他にも、図形にコーディングした関数を埋め込み、図形をクリック時に埋め込めんだ関数を事項することもできます。

要約しますと、この方法で作成したスクリプトはExcelでいうVBAに近い感覚で利用することができます。

#### Standalone Script

Container Bound Script とは対照的に、どのアプリケーションにもバインド（結びつく）していないスクリプトです。
作成されたスクリプトは Googleドライブ に表示されます。

**＜スクリプトを作成する手順＞**
1. Google Chrome で Google ドライブを開きます。
2. Google ドライブの左上に表示されている[新規]ボタンをクリックします。
3. 2. で表示されたメニュー内の[その他]をクリックします。
4. 3. で表示されたメニュー内の[Google Apps Script] をクリックします。

**＜メリット＞**
- 利用者にスクリプトエディタを編集されるリスクがない
- Google ドライブで管理がしやすい

一見、Container Bound Script でスクリプトを作成した方が始めやすく、
バインドしたファイルを簡単に参照できるメソッドも利用できるため扱いやすいです。
しかし、作成したスクリプトを他者と共有して利用したい場合は、
利用者もスクリプトエディタを編集することができてしまいます。
つまり、いつの間にか利用者によってスクリプトの内容が書き換えられてしまうことが起こる可能性があります。

一方で、Standalone Script はスクリプトファイルを共有したアカウントのみ編集することが、ユーザーによって編集されるリスクがありません。
また、作成したスクリプトは Google ドライブに保存されているため管理がしやすいのも特徴です。

（Container Bound Script の場合は対象のファイルを開かなければスクリプトエディタを開くことができません。また、Google ドライブにスクリプトが表示されません。）

**補足**

Google ドライブでは Container Bound Script を管理できないとお話ししましたが、
作成したスクリプトは下記リンク先のダッシュボードから簡単にアクセスすることができます。
https://script.google.com/home

今回のWebアプリ編のハンズオンでは Standalone Script で進めていきます。
Container Bound Script でも問題なく行うことができますが、
後々の管理のことを考えて Standalone Script で進めていきましょう。

---

### HTMLファイルの作り方について
Webアプリを作るには画面を作る必要がありますが、画面はHTMLファイルで作ることができます。
HTMLファイルは下記の手順で作成することができます。
1. 上部メニューから[ファイル] > [New] > [HTMLファイル]　を選択する。
2. 表示されたダイアログの入力欄にファイル名を設定して、[OK] ボタンをクリックします。
　　※ ここではファイル名を「index」としてください。
3. スクリプトエディタ上に「index.html」が作成されます。

```
<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
  </head>
  <body>

  </body>
</html>
```
---

### doGet関数について
ユーザーが公開したWebアプリにアクセスした場合にdoGet関数は実行されます。（別のプログラムからWebアプリにHTTPのGETリクエストが送信される場合も同じく実行されます。）

Web画面を表示するにはdoGet関数の戻り値として **HtmlServiceオブジェクト** を指定する必要があります。

下記のようにコーディングをしますと、`index.html`を表示する画面として指定することができます。

コード.gs
```js
function doGet() {
  return HtmlService.createTemplateFromFile('index').evaluate();
}
```
index.html
```
<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
  </head>
  <body>
    Hello World!
  </body>
</html>
```
---
### Webアプリのデプロイ方法について
作成したWebアプリは次の手順で公開することができます。
1. メニューの「公開」> 「ウェブアプリケーションとして導入」をクリック
2. プロジェクトバージョンを指定して「導入」ボタンをクリック
