---
title: "GASでコーディングしてみよう"
date: 2020-08-10T01:29:17+09:00
pre: "<b>5. </b>"
weight: 5
---
### 関数とは
では早速、GASのスクリプトをコーディングしていきましょう。

スクリプトエディタには既に下記のコードが記述されていると思います。

```js
function myFunction() {

}
```

これは関数と呼ばれ、一連の処理をひとまとめにして名前をつけたものになります。

***{*** と ***}*** の間に1行空いていますが、この間に処理をコーディングしていきます。

コーディングの際は下記のルールに気をつけてください。
下記のルールが守られていない場合は、スクリプトを保存する際にエラーとなります。
- 英数字、記号はすべて ***半角*** であること
- アルファベットの大文字、小文字を間違えないこと（myFunctionとMYFUNCTIONとでは別の関数として認識されます。）

- ピリオドやセミコロンなどの記号の入力漏れや打ち間違いがないこと

---
### メッセージを表示してみる
今回のハンズオンでは「Hello World!」というメッセージをスプレッドシートに表示してみたいと思います。

myFunction関数の　***{*** と ***}*** の間に下記のようにコードを追記してください。

また、追記する際は字下げ（インデント）をしてコードを読みやすくしましょう。
字下げ（インデント）はTabキーをクリックすると行えます。

```js
function myFunction() {
  Browser.msgBox('Hello World!');
}
```

スクリプトを編集した場合は保存をする必要があります。

スクリプトを編集すると、「コード.gs」の前に赤いアスタリスクマークが表示されます。

スクリプトエディタ上のスクリプトは編集をしても自動的に更新はなされないため、編集したスクリプトを反映させるには保存する必要があります。

この赤いアスタリスクマークが表示されている場合は保存がなされていない状態です。

ツールメニューバーの「保存」ボタン（ディスクのアイコン）をクリックすると保存することができます。

赤いアスタリスクのマークがなくなれば保存は完了です！


{{% notice note %}}
スクリプトの保存はショートカットキーがあり、Windonwsは`Ctrl + S`、Macは`command + S`で保存することができます。
{{% /notice %}}


保存が完了すれば、最後にスクリプトの実行です。

スクリプトの実行はツールメニューバーの「実行」ボタン（再生のアイコン）をクリックすると実行することができます。

この際にツールバーに実行する関数の名前が表示されているかを確認しましょう。

{{% notice note %}}
スクリプトの実行はショートカットキーがあり、Windonwsは`Ctrl + R`、Macは`command + R`で実行することができます。
{{% /notice %}}

初回の実行の際は「承認が必要です」というダイアログが表示します。
スクリプトを実行するユーザーに対して、操作対象のスプレッドシートへアクセスする必要があります。

「許可を確認」をクリックすると、さらに小画面が表示されアカウントの一覧が表示されます。

ここで今回のGASを実行するアカウントを選択します。

最後に表示された画面の「許可」ボタンをクリックすると、スクリプトが実行されます。

実行するとスクリプトエディタが表示されており、特に変化は見当たらないと大みます。

では、スプレッドシートの画面に切り替えてみてください。
「Hello World!」とメッセージが表示されているはずです。

（メッセージは「OK」ボタンもしくは右上の「×」ボタンで閉じることができます。）


---
### 関数を更新してみる

作成した関数はもちろん編集することができます。

先ほど作成した`myFunction`関数で表示したメッセージを「Hello World!」から「Hello GAS!」に変更してみましょう。

```js
function myFunction() {
  Browser.msgBox('Hello GAS!');
}
```

先ほどと同じ手順で「保存」→「実行」をしてみましょう。

（2回目以降は承認の手続きは不要のため、承認のダイアログは表示されません。）

「Hello GAS!」とメッセージが表示されていれば成功です！
