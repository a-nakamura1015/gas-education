---
title: "関数"
date: 2020-08-10T13:26:47+09:00
pre: "<b>2. </b>"
weight: 2
---

## 関数とは
入門編で少し解説しましたが、**関数** とは一連の処理をひとまとめにして名前をつけたものです。
「関数（function）」　は文が集まったもので、プログラムを構成する部品の役割をする「サブプログラム」です。
JavaScriptでは関数はとても重要な役割を果たしますが、本章ではその基本的な機能と使い方を紹介します。

### 関数の構文
関数を実行する際は関数名を指定して呼び出します。
関数の作り方にはルールがあり、以下のように **function キーワード** で定義します。
```js
function 関数名() {
  処理
}
```
ここまではデフォルトの「myFunction」という名前の関数を実行してきましたが、関数名は任意につけることができます。
関数名はその関数がどのような処理を行うかがイメージしやすい名前をつけるようにしましょう。
例えば、「ユーザー名を取得する関数」であれば、「getUserName」とするとわかりやすいですよね。
また、波括弧（`{}`）で囲った箇所は、複数のステートメントをまとめたもので **ブロック** といいます。
このブロックは今後の説明する構文で重要な役割を果たします。
ブロックは改行しないで記述することもできますが、改行を入れたほうが読みやすいコードになります。
下記の例で見比べると一目瞭然ですね。
```js
function myFunction() {console.log('Hello GAS');}
```
```js
function myFunction() {
  console.log('Hello GAS');
}
```
それでは、次のサンプルをコーディングして保存してみましょう。
{{< tabs groupId="value_2_1" >}}
{{% tab name="コード.gs" %}}
```js
function sayHello() {
  console.log('Hello!');
}
```
{{% /tab %}}
{{< /tabs >}}
すると、スクリプトエディタのツールバーの「関数選択」のプルダウンに「sayHello」が選択可能となっていることが確認できます。
その関数を選択してスクリプトを実行してそのログ表示を確認してみましょう。
「sayHello」を実行すると、「Hello!」と表示されます。
このように、gsファイルには複数の関数を定義することができます。そして、定義した関数を「関数選択」のプルダウンから選択して実行することができます。

### コーディングする際の注意点
JavaScriptでコーディングする際は基本的に半角英数字と半角記号のみを使用します。
逆にいうと、全角文字は使用することができません。（後述の文字列やコメントでは使用できます。）
また、JavaScriptは同じアルファベットでも大文字と小文字を区別します。
そのため、下記のようなコードを記述するとスクリプトの実行時にエラーが発生します。
{{< tabs groupId="value_2_2" >}}
{{% tab name="コード.gs" %}}
```js
function myFunction() {
  console.Log('Hello GAS!')
}
```
{{% /tab %}}
{{< /tabs >}}
実行すると、「`TypeError：オブジェクトconsoleで関数Logが見つかりません。`」というエラーが発生します。
このようにタイプミスで大文字と小文字を間違えたりするとエラーとなってしまいます。
ちなみに、スクリプトエディタには自動補完機能があるので、この機能を駆使することでタイプミスを防ぐことができます。
