---
title: "配列"
date: 2020-08-10T13:30:37+09:00
pre: "<b>6. </b>"
weight: 6
---

## 配列とは
これまでは変数や定数に値を一つずつ代入して扱ってきましたが、複数のデータを1つにまとめたくなるケースもあります。
例えば、果物の名前を変数で管理したい場合は下記の通りになります。
```js
var fruitsName_1 = 'apple';
var fruitsName_2 = 'grape';
var fruitsName_3 = 'orange';
```
このように一つずつ変数を初期化して扱うことは可能ですが、非常に管理がしづらい問題が発生します。

さらに果物の名前の変数を作りたいとなった場合、fruiteName_Xの形式で変数名を作ることになりますが、
今回の果物が何個目の果物なのかをわざわざ確認しないといけないですよね。

このように、複数のデータをまとめて集合として扱うことができるデータを **配列** といいます。

配列はカンマで値と区切り、全体を角括弧（[]）で囲むことで表現することができます。（これを ***配列リテラル*** といいます。）
```js
[値1, 値2, ...]
```
配列は下記の図のように、複数の箱が連結しているような構造になっています。
それぞれの入れ物には番号が順番に割りふられており、番号は「0」から始まります。
この番号は **インデックス** といい、配列に格納されている値を **要素** といいます。
また、配列は変数に代入することもできます。

下記のサンプルは果物の名前を配列で管理した場合のコードとなります。

```js
function outputArray_1() {
  var fruits = ['apple', 'grape', 'orange'];
  console.log(fruits); // 'apple', 'grape', 'orange'
}
```
また、配列には以下の3つのルールがあります。
- 配列のサイズは固定ではない。（要素の追加、削除で変動する）
- 配列の要素のデータ型は全て同じである必要はない。（[1, 'Taro']も可能）
- 配列の添字（インデックス）は0から始まる。

#### 配列の要素の参照と代入
配列から特定の要素を取り出す場合はインデックスを用います。
```js
配列名[インデックス]
```

下記のサンプルは配列fruitsからインデックスが1の要素をログに出力しています。
インデックスは0から始まるため、インデックスが1の要素は先頭から2番目の要素なので、「grape」が出力されます。
```js
function outputArray_2() {
  var fruits = ['apple', 'grape', 'orange'];
  console.log(fruits[1]); // 'grape'
}
```
また、配列内の特定の要素を代入で更新することもできます。
```js
配列名[インデックス] = 値;
```
配列内に指定したインデックスの要素が存在する場合は上書きされます。
逆に、配列内に指定したインデックスの要素が存在しない場合は要素の追加がなされます。
```js
function outputArray_3() {
  var fruits = ['apple', 'grape', 'orange'];
  fruits[4] = 'peach';
  console.log(fruits); // 'apple', 'grape', 'orange', null, peach
  fruits[3] = 'berry';
  console.log(fruits); // 'apple', 'grape', 'orange', berry, peach
}
```

#### 二次元配列
先ほどは配列の要素をインデックスで指定して値を取り出したり、上書きしたりしました。
実はこの要素には配列を設定することができ、配列の中に配列がある **二次元配列** を作ることができます。
このように配列が入れ子になっている配列を **多次元配列** といいます。
二次元配列は下記のように記述することで初期化することができます。
```js
var foods = [['beef', 'pork', 'chicken'], ['apple', 'grape'], ['tuna']];
```
二次元配列は要素が多くなるほど構造が複雑になりイメージがしづらいかもしれません。
そのようなときは下図のように箱の中に箱があるとイメージすると考えやすくなるでしょう。
{{% notice note %}}
二次元配列に対して、「入れ子」になっていない通常の配列を一次元配列といいます。
{{% /notice %}}
二次元配列から特定の要素を取り出す場合もインデックスを用います。
```js
function outputArray_4() {
  var foods = [['beef', 'pork', 'chicken'], ['apple', 'grape'], ['tuna']];
  console.log(foods[0]); // 'beef', 'pork', 'chicken'
  foods[2] = ['carrot'];
  console.log(foods); // ['beef', 'pork', 'chicken'], ['apple', 'grape'], ['carrot']
}
```
二次元配列の内側の要素を取り出すには、外側のインデックスに続けて内側のインデックスも指定します。
```js
配列名[インデックス1][インデックス2]
```
```js
配列名[インデックス1][インデックス2] = 値;
```
二次元配列の内側の要素の参照、代入および追加は下記のサンプルのように記述することができます。
```js
function outputArray_5() {
  var number = [[1, 2, 3], [10, 20], [100]];
  console.log(number[0][0]); // 1
  console.log(number[1][0]); // 10
  console.log(number[1][1]); // 20
}
```
```js
function outputArray_6() {
  var number = [[1, 2, 3], [10, 20], [100]];
  number[0][0] = 0;   // 要素への代入
  number[2][1] = 200; // 要素の追加
  console.log(number); // [0, 2, 3], [10, 20], [100, 200]
}
```
GASではスプレッドシートのシートの行列のデータを利用する際にこの二次元配列を扱いますので、
一次元配列だけでなく多次元配列についても理解しておく必要があります。
